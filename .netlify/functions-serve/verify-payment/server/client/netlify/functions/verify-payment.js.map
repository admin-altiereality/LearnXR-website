{
  "version": 3,
  "sources": ["../../../../../../Users/gaurav/Desktop/Latest in3d/in3devoneuralwebsite/server/client/netlify/functions/verify-payment.js"],
  "sourceRoot": "/var/folders/kn/cg56x0815_n1rvxzlm8s4wkm0000gn/T/tmp-42075-lyt7Ced7Ng4z",
  "sourcesContent": ["const crypto = require('crypto');\n\nexports.handler = async (event, context) => {\n  // Enable CORS\n  const headers = {\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Headers': 'Content-Type',\n    'Access-Control-Allow-Methods': 'POST, OPTIONS'\n  };\n\n  // Handle preflight requests\n  if (event.httpMethod === 'OPTIONS') {\n    return {\n      statusCode: 200,\n      headers,\n      body: ''\n    };\n  }\n\n  try {\n    const body = JSON.parse(event.body || '{}');\n    const { razorpay_order_id, razorpay_payment_id, razorpay_signature, userId, planId } = body;\n    \n    if (!razorpay_order_id || !razorpay_payment_id || !razorpay_signature) {\n      return {\n        statusCode: 400,\n        headers,\n        body: JSON.stringify({\n          error: 'Missing required payment verification data'\n        })\n      };\n    }\n\n    // Verify signature\n    const generated_signature = crypto\n      .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n      .update(razorpay_order_id + '|' + razorpay_payment_id)\n      .digest('hex');\n\n    if (generated_signature === razorpay_signature) {\n      // Here you would typically update the user's subscription in your database\n      // For now, we'll just return success\n      return {\n        statusCode: 200,\n        headers,\n        body: JSON.stringify({\n          status: 'success',\n          message: 'Payment verified successfully'\n        })\n      };\n    } else {\n      return {\n        statusCode: 400,\n        headers,\n        body: JSON.stringify({\n          error: 'Invalid signature'\n        })\n      };\n    }\n  } catch (error) {\n    console.error('Verify payment error:', error);\n    return {\n      statusCode: 500,\n      headers,\n      body: JSON.stringify({\n        error: 'Failed to verify payment'\n      })\n    };\n  }\n}; "],
  "mappings": ";;;AAAA,IAAM,SAAS,QAAQ,QAAQ;AAE/B,QAAQ,UAAU,OAAO,OAAO,YAAY;AAE1C,QAAM,UAAU;AAAA,IACd,+BAA+B;AAAA,IAC/B,gCAAgC;AAAA,IAChC,gCAAgC;AAAA,EAClC;AAGA,MAAI,MAAM,eAAe,WAAW;AAClC,WAAO;AAAA,MACL,YAAY;AAAA,MACZ;AAAA,MACA,MAAM;AAAA,IACR;AAAA,EACF;AAEA,MAAI;AACF,UAAM,OAAO,KAAK,MAAM,MAAM,QAAQ,IAAI;AAC1C,UAAM,EAAE,mBAAmB,qBAAqB,oBAAoB,QAAQ,OAAO,IAAI;AAEvF,QAAI,CAAC,qBAAqB,CAAC,uBAAuB,CAAC,oBAAoB;AACrE,aAAO;AAAA,QACL,YAAY;AAAA,QACZ;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAGA,UAAM,sBAAsB,OACzB,WAAW,UAAU,QAAQ,IAAI,mBAAmB,EACpD,OAAO,oBAAoB,MAAM,mBAAmB,EACpD,OAAO,KAAK;AAEf,QAAI,wBAAwB,oBAAoB;AAG9C,aAAO;AAAA,QACL,YAAY;AAAA,QACZ;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,QAAQ;AAAA,UACR,SAAS;AAAA,QACX,CAAC;AAAA,MACH;AAAA,IACF,OAAO;AACL,aAAO;AAAA,QACL,YAAY;AAAA,QACZ;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,yBAAyB,KAAK;AAC5C,WAAO;AAAA,MACL,YAAY;AAAA,MACZ;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,EACF;AACF;",
  "names": []
}
