{"version":3,"sources":["../src/config/env.ts","../src/server.ts","../src/routes.ts","../src/lib/sdk.ts","../src/controllers/skybox.controller.ts","../src/controllers/imagine.controller.ts"],"sourcesContent":["import * as dotenv from \"dotenv\";\nimport { str, envsafe, port } from \"envsafe\";\n\ndotenv.config();\n\nexport const env = envsafe({\n  NODE_ENV: str({\n    devDefault: \"development\",\n    choices: [\"development\", \"test\", \"production\"],\n  }),\n  SERVER_PORT: port({\n    devDefault: 5002,\n    desc: \"The port the app is running on\",\n  }),\n  API_KEY: str({\n    desc: \"BlockadeLabs API KEY\",\n  }),\n});\n","import { env } from \"@/config/env\";\nimport cors from \"cors\";\nimport express, { json } from \"express\";\nimport { router } from \"@/routes\";\nimport path from 'path';\n\nconst server = express();\n\nserver.use(json());\n\n// Get the absolute path to the build directory\nconst buildPath = path.resolve(process.cwd(), 'client/dist');\n\n// Serve static files from the React app build directory\nserver.use(express.static(buildPath, {\n  setHeaders: (res) => {\n    res.set('Access-Control-Allow-Origin', '*');\n    res.set('Access-Control-Allow-Methods', 'GET');\n    res.set('Access-Control-Allow-Headers', 'Content-Type');\n  }\n}));\n\nconst corsOptions = {\n  origin: [\n    'https://in3d.evoneural.ai',\n    'http://localhost:3000',\n    'http://localhost:5173',\n    '${apiUrl}'\n  ],\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n  allowedHeaders: ['Content-Type', 'Authorization', 'X-Requested-With']\n};\n\nserver.use(cors(corsOptions));\n\nserver.use(\"/api\", router);\n\n// Handle React routing, return all requests to React app\nserver.get('*', function(req, res) {\n  const indexPath = path.join(buildPath, 'index.html');\n  \n  // Log the path being accessed (helpful for debugging)\n  console.log('Attempting to serve:', indexPath);\n  \n  res.sendFile(indexPath, function(err) {\n    if (err) {\n      console.error('Error serving index.html:', err);\n      res.status(500).send(err);\n    }\n  });\n});\n\nserver.listen(env.SERVER_PORT, async () => {\n  console.log(`Server is running at port ${env.SERVER_PORT}`);\n  console.log('Build path:', buildPath);\n});\n","import * as express from \"express\";\nimport multer from \"multer\";\n\nimport {\n  getSkyboxStyles,\n  generateSkybox,\n} from \"@/controllers/skybox.controller\";\nimport {\n  getGenerators,\n  generateImagine,\n  getImagineById,\n  getImagineByObfuscatedId,\n  getImagineHistory,\n  cancelImagine,\n  cancelAllPedingImagines,\n  deleteImagine,\n} from \"@/controllers/imagine.controller\";\n\nconst router = express.Router();\n\nrouter.get(\"/skybox/getSkyboxStyles\", getSkyboxStyles);\nrouter.post(\"/skybox/generateSkybox\", generateSkybox);\n\nrouter.get(\"/imagine/getGenerators\", getGenerators);\n\n// Using multer here to proccess multipart files\nrouter.post(\"/imagine/generateImagine\", multer().any(), generateImagine);\n\nrouter.get(\"/imagine/getImagineById\", getImagineById);\nrouter.get(\"/imagine/getImagineByObfuscatedId\", getImagineByObfuscatedId);\nrouter.get(\"/imagine/getImagineHistory\", getImagineHistory);\nrouter.post(\"/imagine/cancelImagine\", cancelImagine);\nrouter.post(\"/imagine/cancelAllPedingImagines\", cancelAllPedingImagines);\nrouter.delete(\"/imagine/deleteImagine\", deleteImagine);\n\nexport { router };\n","import { BlockadeLabsSdk } from \"@blockadelabs/sdk\";\nimport { env } from \"@/config/env\";\n\nexport const sdk = new BlockadeLabsSdk({ api_key: env.API_KEY });\n","import { Request, Response } from \"express\";\nimport { sdk } from \"@/lib/sdk\";\n\nexport const getSkyboxStyles = async (_req: Request, res: Response) => {\n  try {\n    const skyboxStyles = await sdk.getSkyboxStyles();\n\n    return res.status(200).json(skyboxStyles);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error retrieving skybox styles\" });\n  }\n};\n\nexport const generateSkybox = async (req: Request, res: Response) => {\n  try {\n    const { prompt, skybox_style_id, remix_imagine_id, webhook_url } = req.body;\n\n    const generation = await sdk.generateSkybox({\n      prompt,\n      skybox_style_id,\n      remix_id: remix_imagine_id,\n      webhook_url,\n    });\n\n    return res.status(200).json(generation);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error generating new skybox\" });\n  }\n};\n","import { Request, Response } from \"express\";\nimport { sdk } from \"@/lib/sdk\";\n\nexport const getImagineById = async (req: Request, res: Response) => {\n  try {\n    const { id } = req.query;\n\n    const imagine = await sdk.getImagineById({ id: String(id) });\n\n    return res.status(200).json(imagine);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error retrieving imagine\" });\n  }\n};\n\nexport const getImagineByObfuscatedId = async (req: Request, res: Response) => {\n  try {\n    const { obfuscated_id } = req.query;\n\n    const imagine = await sdk.getImagineByObfuscatedId({\n      obfuscated_id: String(obfuscated_id),\n    });\n\n    return res.status(200).json(imagine);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error retrieving imagine\" });\n  }\n};\n\nexport const getImagineHistory = async (req: Request, res: Response) => {\n  try {\n    const { status, limit, offset, order, imagine_id, query, generator } =\n      req.query;\n\n    const imagineHistory = await sdk.getImagineHistory({\n      status: status ? String(status) : undefined,\n      limit: limit ? Number(limit) : undefined,\n      offset: offset ? Number(offset) : undefined,\n      order: order ? (String(order) as \"ASC\" | \"DESC\") : undefined,\n      imagine_id: imagine_id ? Number(imagine_id) : undefined,\n      query: query ? String(query) : undefined,\n      generator: generator ? String(generator) : undefined,\n    });\n\n    return res.status(200).json(imagineHistory);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error retrieving imagine history\" });\n  }\n};\n\nexport const cancelImagine = async (req: Request, res: Response) => {\n  try {\n    const { id } = req.query;\n\n    await sdk.cancelImagine({\n      id: String(id),\n    });\n\n    return res\n      .status(200)\n      .json({ message: `imagine: ${id} cancelled with success!` });\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error canceling imagine\" });\n  }\n};\n\nexport const cancelAllPedingImagines = async (req: Request, res: Response) => {\n  try {\n    await sdk.cancelAllPendingImagines();\n\n    return res\n      .status(200)\n      .json({ message: \"Pending imagines cancelled with success!\" });\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error canceling pending imagines\" });\n  }\n};\n\nexport const deleteImagine = async (req: Request, res: Response) => {\n  try {\n    const { id } = req.query;\n\n    await sdk.deleteImagine({ id: String(id) });\n\n    return res\n      .status(200)\n      .json({ message: `imagine: ${id} deleted with success!` });\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res.status(400).json({ error: \"Unexpected error deleting imagine\" });\n  }\n};\n\nexport const getGenerators = async (_req: Request, res: Response) => {\n  try {\n    const generators = await sdk.getGenerators();\n    return res.status(200).json(generators);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error retrieving generators\" });\n  }\n};\n\nexport const generateImagine = async (req: Request, res: Response) => {\n  try {\n    const { prompt, style_id, options, webhook_url } = req.body;\n\n    const generation = await sdk.generateImagine({\n      generator: style_id,\n      generator_data: {\n        prompt,\n        options,\n        webhook_url,\n      },\n    });\n\n    return res.status(200).json(generation);\n  } catch (err) {\n    if (err && typeof err === \"object\" && \"message\" in err)\n      return res.status(400).json({ error: err.message });\n\n    return res\n      .status(400)\n      .json({ error: \"Unexpected error generating imagine\" });\n  }\n};\n"],"mappings":"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","names":["multer","express","path","cors"]}